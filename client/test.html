<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title>all game blocks</title>
  </head>
  <body style="position:fixed;width:100vw;height:100vh;margin:0">

  </body>
  <script type="module">
    import * as THREE from './ThreeJsLib/build/three.module.js';
    import {MAIN} from './scripts/main.js';
    import {TEXTURES_BASE} from './scripts/modules/bases/textures_base.js';
    import {MESHES_BASE} from './scripts/modules/bases/meshes_base.js';
    import {BLOCKS_BASE} from './scripts/modules/bases/blocks_base.js';
    MAIN.render.init();

    TEXTURES_BASE.init().then(result => {
      MESHES_BASE.init();
      BLOCKS_BASE.init();

      const canvas = document.createElement('canvas');
      const textureSize = 64
      canvas.width = textureSize;
      canvas.height = textureSize;
      canvas.style.position = 'fixed';
      canvas.style.top = '30vh';
      canvas.style.left = '30vh';
      canvas.style.border = '1px solid black';
      document.body.appendChild(canvas);
      const ctx = canvas.getContext('2d');


      const block =  MESHES_BASE.getMesh('test');
      MAIN.render.scene.add(block);
      const block2 =  MESHES_BASE.getMesh('test');
      block2.position.z = 1;
      MAIN.render.scene.add(block2);

      const image = block.material[0].map.image;
      ctx.imageSmoothingEnabled = false;



      const lightValue = 8;
      //soft shadow = false;
      //рисуем первую текстуру
      ctx.drawImage(image, 0, 0, textureSize, textureSize);

      //Soft shadow = true;


      //угол 1
      let gradient = ctx.createLinearGradient(0,textureSize/2, textureSize,textureSize/2);
      gradient.addColorStop(0, `rgba(0,0,0,${1})`);
      gradient.addColorStop(1, 'rgba(0,0,0,0.5)');
      ctx.fillStyle = gradient;
      ctx.fillRect(0, 0, textureSize, textureSize);


      //вещаем на блок
      block.material[0].map = new THREE.CanvasTexture(canvas);
      block.material[0].map.magFilter = THREE.NearestFilter;




      MAIN.render.render();
    });





  </script>
</html>
